//===================================================================================
//  File       : led.c
//-----------------------------------------------------------------------------------
//  Object     : 
//
//  contents   : 
//
//===================================================================================
//-----------------------------------------------------------------------------------
// Date     | Author | Revision       | Description
//----------+--------+----------------+----------------------------------------------
// 11.11.09 | EDRIT  |                | Initial revision
//----------+--------+----------------+----------------------------------------------
//===================================================================================
#define LED_GLOBALS
//-----------------------------------------------------------------------------------
//                             INCLUDE FILE
//-----------------------------------------------------------------------------------
#include <avr/io.h>
#include "led.h"
//-----------------------------------------------------------------------------------
//                             TYPE DEFINITION
//-----------------------------------------------------------------------------------

//-----------------------------------------------------------------------------------
//                             FUNCTION PROTOTYPE
//-----------------------------------------------------------------------------------
void toggleLedBit   (uint8_t ledBit);
void toggleLedAll   (void);

//-----------------------------------------------------------------------------------
//                             ENUMERATION
//-----------------------------------------------------------------------------------

//-----------------------------------------------------------------------------------
//                             LOCAL DATA DECLARATIONS
//-----------------------------------------------------------------------------------

//===================================================================================
//  Function   : LED_Init
//-----------------------------------------------------------------------------------
//  Object     : 
//
//  Return     : -
//
//-----------------------------------------------------------------------------------
//  Argument Name     |IN |OUT| Utilisation
//--------------------+---+---+------------------------------------------------------
//                    |   |   |
//--------------------+---+---+------------------------------------------------------
//===================================================================================
void LED_Init(void)
{
    // Set direction of PORTD2 ~ PORTD5 as output
    // Turn off PORTD2 ~ PORTD5
    DDRD    |= (1 << DDD5) | (1 << DDD4) | (1 << DDD3) | (1 << DDD2);
    PORTD   &= ~(1 << DDD5) | ~(1 << DDD4) | ~(1 << DDD3) | ~(1 << DDD2);
}

void LED_BlinkTask (void)
{
    toggleLedAll();
}

void toggleLedBit(uint8_t ledBit)
{
    uint8_t ledMask = (1 << ledBit);

    if (LED_PORT & ledMask) {
        LED_PORT   &= ~ledMask;
    }
    else {
        LED_PORT   |= ledMask;
    }
}

void toggleLedAll(void)
{
    uint8_t led;

    for (led = LED_1; led < LED_N; led++) {
        toggleLedBit(led);
    }
}